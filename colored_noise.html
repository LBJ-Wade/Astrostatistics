
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Colored Noise &#8212; Astrostatistics</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gaussian Processes" href="gaussian_processes.html" />
    <link rel="prev" title="Regression and Curve Fitting" href="regression_and_curve_fitting.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Astrostatistics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   PHY 688: Numerical Methods in Astrophysics.
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="welcome.html">
   An Example to Set the Stage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="syllabus.html">
   PHY 688: Computational Astrophysics Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regression_and_curve_fitting.html">
   Regression and Curve Fitting
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Colored Noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gaussian_processes.html">
   Gaussian Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="populations.html">
   Populations and Catalogs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="selection_effects.html">
   Selection Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="special_methods.html">
   Special Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tips_and_tricks.html">
   Tips and Tricks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project_ideas.html">
   Project Ideas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/colored_noise.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/farr/Astrostatistics"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/farr/Astrostatistics/issues/new?title=Issue%20on%20page%20%2Fcolored_noise.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/farr/Astrostatistics/main?urlpath=tree/astrostatistics/colored_noise.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-random-notes-from-lecture">
   Some random notes from Lecture
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#an-example-from-ligo">
   An Example from LIGO
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#state-space-models">
   State Space Models
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="colored-noise">
<h1>Colored Noise<a class="headerlink" href="#colored-noise" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pylab</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;svg&#39;

<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">celerite2</span>
<span class="kn">from</span> <span class="nn">celerite2</span> <span class="kn">import</span> <span class="n">terms</span>
<span class="kn">from</span> <span class="nn">celerite2.theano</span> <span class="kn">import</span> <span class="n">terms</span> <span class="k">as</span> <span class="n">theano_terms</span>
<span class="kn">import</span> <span class="nn">celerite2.theano</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">pymc3</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">pymc3_ext</span> <span class="k">as</span> <span class="nn">pmx</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">welch</span><span class="p">,</span> <span class="n">decimate</span>
<span class="kn">from</span> <span class="nn">scipy.signal.windows</span> <span class="kn">import</span> <span class="n">tukey</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">stan_jupyter</span> <span class="k">as</span> <span class="nn">stan</span>
<span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="k">as</span> <span class="nn">T</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;ticks&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
</pre></div>
</div>
</div>
</div>
<div class="section" id="some-random-notes-from-lecture">
<h2>Some random notes from Lecture<a class="headerlink" href="#some-random-notes-from-lecture" title="Permalink to this headline">¶</a></h2>
<p>Correlated Noise</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mf">0.9</span><span class="p">],</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x13e8d8d30&gt;]
</pre></div>
</div>
<img alt="_images/colored_noise_5_1.svg" src="_images/colored_noise_5_1.svg" /></div>
</div>
<p>Here we made a Gaussian process with kernel
$<span class="math notranslate nohighlight">\(
k\left( x_i, x_j \right) = \sigma^2 \exp\left( -\frac{1}{2} \left(\frac{x_i - x_j}{\lambda} \right)^2 \right).
\)</span>$
For obvious reasons, this is called the “squared exponential kernel.”  A good place to learn a lot about Gaussian processes, kernel functions, etc, etc, is <span id="id1">[<a class="reference internal" href="bibliography.html#id12">Rasmussen and Williams, 2006</a>]</span>, which can be found online <a class="reference external" href="http://www.gaussianprocess.org/gpml/chapters/">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="n">sigma2</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="k">def</span> <span class="nf">k</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">xj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sigma2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">xi</span><span class="o">-</span><span class="n">xj</span><span class="p">)</span><span class="o">/</span><span class="n">lambda2</span><span class="p">)</span>

<span class="n">Sigma</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
        <span class="n">Sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">imshow</span><span class="p">(</span><span class="n">Sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x147ec4d00&gt;
</pre></div>
</div>
<img alt="_images/colored_noise_7_1.svg" src="_images/colored_noise_7_1.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="n">Sigma</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/colored_noise_8_0.svg" src="_images/colored_noise_8_0.svg" /></div>
</div>
<div class="math notranslate nohighlight">
\[
\rho(\tau) = \sigma^2 \exp\left( -\frac{\left| \tau \right|}{\lambda} \right)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="n">sigma2</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="k">def</span> <span class="nf">k</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">xj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sigma2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xi</span><span class="o">-</span><span class="n">xj</span><span class="p">)</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>

<span class="n">Sigma</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
        <span class="n">Sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">imshow</span><span class="p">(</span><span class="n">Sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1480b0a60&gt;
</pre></div>
</div>
<img alt="_images/colored_noise_10_1.svg" src="_images/colored_noise_10_1.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="n">Sigma</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/colored_noise_11_0.svg" src="_images/colored_noise_11_0.svg" /></div>
</div>
</div>
<div class="section" id="an-example-from-ligo">
<h2>An Example from LIGO<a class="headerlink" href="#an-example-from-ligo" title="Permalink to this headline">¶</a></h2>
<p>I downloaded the Hanford LIGO data for GW150914 from <a class="reference external" href="https://www.gw-openscience.org/eventapi/html/GWTC-1-confident/GW150914/v3">GWOSC</a>.  There are a number of different data products there, but I grabbed the 4 kHz sample rate, 32 second long segment surrounding this event.  I also grabbed the “parameter estimation” posterior samples from the same place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;data/H-H1_GWOSC_4KHZ_R1-1126259447-32.hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">strain</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;strain/Strain&#39;</span><span class="p">])</span>
    <span class="n">strain_start</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;meta/GPSstart&#39;</span><span class="p">])[()]</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">4096.0</span>
    <span class="n">strain_times</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">strain</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">strain</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;data/GW150914_GWTC-1.hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">postsamples</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;Overall_posterior&#39;</span><span class="p">])</span>
<span class="n">t_approx</span> <span class="o">=</span> <span class="mf">1126259462.422</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">strain_times</span><span class="p">,</span> <span class="n">strain</span><span class="p">)</span>
<span class="n">axvline</span><span class="p">(</span><span class="n">t_approx</span> <span class="o">-</span> <span class="n">strain_start</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t / \mathrm</span><span class="si">{s}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$h(t)$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;$h(t)$&#39;)
</pre></div>
</div>
<img alt="_images/colored_noise_16_1.svg" src="_images/colored_noise_16_1.svg" /></div>
</div>
<p>We know the 150914 signal ends at low frequency (&lt; 500 Hz), so we will decimate this data to 1024 sample rate (i.e. by a factor of 4):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lowpass_strain</span> <span class="o">=</span> <span class="n">decimate</span><span class="p">(</span><span class="n">strain</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">lowpass_strain_times</span> <span class="o">=</span> <span class="n">strain_times</span><span class="p">[::</span><span class="mi">4</span><span class="p">]</span>
<span class="n">lowpass_dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">seglen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">lowpass_dt</span><span class="p">))</span>
<span class="n">fs</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">welch</span><span class="p">(</span><span class="n">lowpass_strain</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">lowpass_dt</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">seglen</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loglog</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">psd</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f / \mathrm</span><span class="si">{Hz}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$P(f) / \mathrm</span><span class="si">{strain}</span><span class="s1">^2 \, \mathrm</span><span class="si">{Hz}</span><span class="s1">^{-1}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;$P(f) / \\mathrm{strain}^2 \\, \\mathrm{Hz}^{-1}$&#39;)
</pre></div>
</div>
<img alt="_images/colored_noise_20_1.svg" src="_images/colored_noise_20_1.svg" /></div>
</div>
<p>Let’s whiten the data: the PSD measures the density of the variance in frequency space, so the s.d. in a frequency bin is <span class="math notranslate nohighlight">\(\sqrt{P(f)*\delta f}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">whiten</span><span class="p">(</span><span class="n">strain</span><span class="p">,</span> <span class="n">interp_psd</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">strain</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="c1"># whitening: transform to freq domain, divide by asd, then transform back, </span>
    <span class="c1"># taking care to get normalization right.</span>
    <span class="n">hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">strain</span><span class="p">)</span>
    <span class="n">white_hf</span> <span class="o">=</span> <span class="n">hf</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">interp_psd</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span> <span class="o">/</span><span class="n">dt</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span>
    <span class="n">white_ht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">white_hf</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">Nt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">white_ht</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">white_strain</span> <span class="o">=</span> <span class="n">whiten</span><span class="p">(</span><span class="n">lowpass_strain</span><span class="p">,</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">psd</span><span class="p">),</span> <span class="n">lowpass_dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">lowpass_strain_times</span><span class="p">,</span> <span class="n">white_strain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x147bf1c40&gt;]
</pre></div>
</div>
<img alt="_images/colored_noise_24_1.svg" src="_images/colored_noise_24_1.svg" /></div>
</div>
<p>Funky things happen at the end of the segment.  Why is that?  (Periodicity.)  It’s better to whiten a <em>windowed</em> version of the data that enforces periodicity.  Here we use a Tukey window (which tapers off to zero on either end over one-second intervals):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">strain_window</span> <span class="o">=</span> <span class="n">tukey</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lowpass_strain</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="mi">32</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">lowpass_strain_times</span><span class="p">,</span> <span class="n">strain_window</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x147c3d940&gt;]
</pre></div>
</div>
<img alt="_images/colored_noise_26_1.svg" src="_images/colored_noise_26_1.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">white_strain</span> <span class="o">=</span> <span class="n">whiten</span><span class="p">(</span><span class="n">lowpass_strain</span><span class="o">*</span><span class="n">strain_window</span><span class="p">,</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">psd</span><span class="p">),</span> <span class="n">lowpass_dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">lowpass_strain_times</span><span class="p">,</span> <span class="n">white_strain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x147ca8910&gt;]
</pre></div>
</div>
<img alt="_images/colored_noise_28_1.svg" src="_images/colored_noise_28_1.svg" /></div>
</div>
<p>And here’s our merger:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imerg</span> <span class="o">=</span> <span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">lowpass_strain_times</span> <span class="o">-</span> <span class="p">(</span><span class="n">t_approx</span> <span class="o">-</span> <span class="n">strain_start</span><span class="p">)))</span>
<span class="n">rng</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">imerg</span><span class="o">-</span><span class="mf">0.2</span><span class="o">/</span><span class="n">lowpass_dt</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">imerg</span><span class="o">+</span><span class="mf">0.05</span><span class="o">/</span><span class="n">lowpass_dt</span><span class="p">)))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">lowpass_strain_times</span><span class="p">[</span><span class="n">rng</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">t_approx</span><span class="o">-</span><span class="n">strain_start</span><span class="p">),</span> <span class="n">white_strain</span><span class="p">[</span><span class="n">rng</span><span class="p">])</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t - t_c$ $(\mathrm</span><span class="si">{s}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$h(t)$ (whitened)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;$h(t)$ (whitened)&#39;)
</pre></div>
</div>
<img alt="_images/colored_noise_30_1.svg" src="_images/colored_noise_30_1.svg" /></div>
</div>
<p>A good place to go for discussions like what we are about to have is the <a class="reference external" href="https://arxiv.org/abs/1608.01940">“GW150914 basic physics” paper</a> <span id="id2">[<a class="reference internal" href="bibliography.html#id13">Abbott <em>et al.</em>, 2016</a>]</span>; for “real” post Newtonian expansions, see <span id="id3">[<a class="reference internal" href="bibliography.html#id14">Blanchet, 2014</a>]</span>.  The basic physics paper gives the evolution of the <em>inspiral</em> phase with time:
$<span class="math notranslate nohighlight">\(
\frac{1}{2\pi} \frac{\mathrm{d} \Phi}{\mathrm{d} t} = f_\mathrm{GW} = \frac{5^{3/8}}{\left( 8 \pi \right)} \left( \frac{G M_c}{c^3} \right)^{-5/8} \left( t - t_c \right)^{-3/8}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">lowpass_strain_times</span><span class="p">[</span><span class="n">rng</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">t_approx</span><span class="o">-</span><span class="n">strain_start</span><span class="p">)</span>
<span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">4.9e-6</span><span class="o">*</span><span class="mf">20.0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">ts</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">8.0</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t / \mathrm</span><span class="si">{s}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f_{\mathrm</span><span class="si">{GW}</span><span class="s1">} / \mathrm</span><span class="si">{Hz}</span><span class="s1">$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/ipykernel_6604/3102124229.py:2: RuntimeWarning: invalid value encountered in power
  fs = (1100.0*(4.9e-6*20.0)**(5.0/3.0)*(-ts))**(-3.0/8.0)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;$f_{\\mathrm{GW}} / \\mathrm{Hz}$&#39;)
</pre></div>
</div>
<img alt="_images/colored_noise_32_2.svg" src="_images/colored_noise_32_2.svg" /></div>
</div>
<p>Because the inspiral frequency reaches <span class="math notranslate nohighlight">\(\infty\)</span> in finite time, we will have to do something.  Here’s something:</p>
<ul class="simple">
<li><p>To truncate the frequency at some <span class="math notranslate nohighlight">\(f_\mathrm{max}\)</span> (a parameter).</p></li>
<li><p>To have an exponentially-damped amplitude decay once the frequency reaches <span class="math notranslate nohighlight">\(f_\mathrm{max}\)</span>.</p></li>
<li><p>To use a power-law amplitude with unknown index.</p></li>
</ul>
<p>So
$<span class="math notranslate nohighlight">\(
h(t) = A_{100} \left( \frac{f(t)}{100 \, \mathrm{Hz}} \right)^\alpha \cos \left( \phi_0 + \Phi(t) \right) \frac{1}{1 + \exp\left( \frac{t - t\left(f_\mathrm{max}\right)}{\tau} \right)}
\)</span><span class="math notranslate nohighlight">\(
with
\)</span><span class="math notranslate nohighlight">\(
f(t) = \begin{cases}
\left( \frac{\left( 8 \pi \right)^{8/3}}{5} \left( \frac{G \mathcal{M}}{c^3} \right)^{5/3} \left( t_c - t \right) \right)^{-3/8} &amp; f(t) &lt; f_\mathrm{max} \\
f_\mathrm{max} &amp; \mathrm{otherwise}
\end{cases}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">low_pass_filter_amplitude</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">frolloff</span><span class="p">,</span> <span class="n">fwidth</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">((</span><span class="n">fs</span> <span class="o">-</span> <span class="n">frolloff</span><span class="p">)</span><span class="o">/</span><span class="n">fwidth</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">basic_waveform</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">A100</span><span class="p">,</span> <span class="n">dlnAdlnf</span><span class="p">,</span> <span class="n">Mc</span><span class="p">,</span> <span class="n">tc</span><span class="p">,</span> <span class="n">phic</span><span class="p">,</span> <span class="n">max_freq</span><span class="p">,</span> <span class="n">tau</span><span class="p">):</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">4.9e-6</span><span class="o">*</span><span class="n">Mc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tc</span><span class="o">-</span><span class="n">ts</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">8.0</span><span class="p">)</span>

    <span class="n">tmax</span> <span class="o">=</span> <span class="n">tc</span> <span class="o">-</span> <span class="n">max_freq</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">8.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">4.9e-6</span><span class="o">*</span><span class="n">Mc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">))</span>
    
    <span class="n">Phiinsp</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">8.0</span><span class="o">/</span><span class="mf">5.0</span><span class="o">*</span><span class="p">(</span><span class="mf">1100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">4.9e-6</span><span class="o">*</span><span class="n">Mc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">8.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tc</span> <span class="o">-</span> <span class="n">ts</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">8.0</span><span class="p">)</span>
    <span class="n">Phiconst</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">8.0</span><span class="o">/</span><span class="mf">5.0</span><span class="o">*</span><span class="p">(</span><span class="mf">1100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">4.9e-6</span><span class="o">*</span><span class="n">Mc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">8.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tc</span> <span class="o">-</span> <span class="n">tmax</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">8.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">max_freq</span><span class="o">*</span><span class="p">(</span><span class="n">tmax</span><span class="o">-</span><span class="n">ts</span><span class="p">)</span>
    
    <span class="n">Phi</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">ts</span> <span class="o">&lt;</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">Phiinsp</span><span class="p">,</span> <span class="n">Phiconst</span><span class="p">)</span>
        
    <span class="n">fs</span><span class="p">[(</span><span class="n">fs</span> <span class="o">&gt;=</span> <span class="n">max_freq</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">ts</span> <span class="o">&gt;=</span> <span class="n">tc</span><span class="p">)]</span> <span class="o">=</span> <span class="n">max_freq</span>
    
    <span class="n">amps</span> <span class="o">=</span> <span class="n">A100</span><span class="o">*</span><span class="p">(</span><span class="n">fs</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="n">dlnAdlnf</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">low_pass_filter_amplitude</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span><span class="o">*</span><span class="n">amps</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phic</span> <span class="o">-</span> <span class="n">Phi</span><span class="p">)</span><span class="o">*</span><span class="n">low_pass_filter_amplitude</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">basic_waveform</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">white_strain</span><span class="p">[</span><span class="n">rng</span><span class="p">])</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t-t_\mathrm</span><span class="si">{GW150914}</span><span class="s1">$ ($\mathrm</span><span class="si">{s}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Whitened Strain&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/ipykernel_6604/4150586030.py:4: RuntimeWarning: invalid value encountered in power
  fs = (1100.0*(4.9e-6*Mc)**(5.0/3.0)*(tc-ts))**(-3.0/8.0)
/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/ipykernel_6604/4150586030.py:8: RuntimeWarning: invalid value encountered in power
  Phiinsp = 2.0*pi*8.0/5.0*(1100.0*(4.9e-6*Mc)**(5.0/3.0))**(-3.0/8.0)*(tc - ts)**(5.0/8.0)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Whitened Strain&#39;)
</pre></div>
</div>
<img alt="_images/colored_noise_35_2.svg" src="_images/colored_noise_35_2.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;nt&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">),</span>
    <span class="s1">&#39;ts&#39;</span><span class="p">:</span> <span class="n">ts</span><span class="p">,</span>
    <span class="s1">&#39;h_obs&#39;</span><span class="p">:</span> <span class="n">white_strain</span><span class="p">[</span><span class="n">rng</span><span class="p">]</span>
<span class="p">}</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;stan/phenom_model.stan&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">stan</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">program_code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Building:</span> found in cache, done.
<span class=" -Color -Color-Cyan">Messages from </span><span class=" -Color -Color-Bold -Color-Bold-Cyan">stanc</span><span class=" -Color -Color-Cyan">:</span>
Warning in &#39;/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/httpstan_zxfqm9oh/model_qsspgd2o.stan&#39;, line 138, column 19: Argument 0.01 suggests there may be parameters that are not unit scale; consider rescaling with a multiplier (see manual section 22.12).
Warning in &#39;/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/httpstan_zxfqm9oh/model_qsspgd2o.stan&#39;, line 16, column 29: The variable fs may not have been assigned a value before its use.
Warning: The parameter phi_x has no priors.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_pystan</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_chains</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">Sampling:</span>   0%
<span class=" -Color -Color-Cyan">Sampling:</span>   0% (1/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   0% (2/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   0% (3/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   0% (4/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   1% (103/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   3% (203/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   4% (302/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   5% (401/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   6% (501/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   8% (600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>   9% (700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  10% (800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  11% (900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  12% (1000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  14% (1100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  15% (1200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  16% (1300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  18% (1400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  19% (1500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  20% (1600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  21% (1700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  22% (1800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  24% (1900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  25% (2000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  26% (2100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  28% (2200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  29% (2300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  30% (2400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  31% (2500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  32% (2600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  34% (2700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  35% (2800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  36% (2900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  38% (3000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  39% (3100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  40% (3201/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  41% (3301/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  43% (3402/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  44% (3501/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  45% (3601/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  46% (3700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  48% (3800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  49% (3901/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  50% (4001/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  51% (4101/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  53% (4201/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  54% (4300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  55% (4400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  56% (4500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  58% (4600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  59% (4700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  60% (4800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  61% (4900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  62% (5000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  64% (5100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  65% (5200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  66% (5300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  68% (5400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  69% (5500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  70% (5600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  71% (5700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  72% (5800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  74% (5900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  75% (6000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  76% (6100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  78% (6200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  79% (6301/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  80% (6401/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  81% (6501/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  83% (6601/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  84% (6700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  85% (6800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  86% (6900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  88% (7000/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  89% (7100/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  90% (7200/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  91% (7300/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  92% (7400/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  94% (7500/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  95% (7600/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  96% (7700/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  98% (7800/8000)
<span class=" -Color -Color-Cyan">Sampling:</span>  99% (7900/8000)
<span class=" -Color -Color-Cyan">Sampling:</span> 100% (8000/8000)
<span class=" -Color -Color-Green">Sampling:</span> 100% (8000/8000), done.
<span class=" -Color -Color-Cyan">Messages received during sampling:</span>
  Gradient evaluation took 0.000112 seconds
  1000 transitions using 10 leapfrog steps per transition would take 1.12 seconds.
  Adjust your expectations accordingly!
  Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:
  Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/httpstan_60ciys2i/model_qsspgd2o.stan&#39;, line 131, column 2 to column 33)
  If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,
  but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.
  Gradient evaluation took 0.000211 seconds
  1000 transitions using 10 leapfrog steps per transition would take 2.11 seconds.
  Adjust your expectations accordingly!
  Gradient evaluation took 0.000205 seconds
  1000 transitions using 10 leapfrog steps per transition would take 2.05 seconds.
  Adjust your expectations accordingly!
  Gradient evaluation took 0.000205 seconds
  1000 transitions using 10 leapfrog steps per transition would take 2.05 seconds.
  Adjust your expectations accordingly!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A100&#39;</span><span class="p">,</span> <span class="s1">&#39;dlnAdlnf&#39;</span><span class="p">,</span> <span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="s1">&#39;tc&#39;</span><span class="p">,</span> <span class="s1">&#39;Mc&#39;</span><span class="p">,</span> <span class="s1">&#39;max_freq&#39;</span><span class="p">,</span> <span class="s1">&#39;tau&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;AxesSubplot:title={&#39;center&#39;:&#39;A100&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;A100&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;dlnAdlnf&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;dlnAdlnf&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;phi&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;phi&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;tc&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;tc&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;Mc&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;Mc&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;max_freq&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;max_freq&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;tau&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;tau&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;sigma&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;sigma&#39;}&gt;]], dtype=object)
</pre></div>
</div>
<img alt="_images/colored_noise_38_1.svg" src="_images/colored_noise_38_1.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">fit</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">h_model</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">white_strain</span><span class="p">[</span><span class="n">rng</span><span class="p">])</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t-t_\mathrm</span><span class="si">{GW150914}</span><span class="s1">$ ($\mathrm</span><span class="si">{s}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Whitened Strain&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Whitened Strain&#39;)
</pre></div>
</div>
<img alt="_images/colored_noise_39_1.svg" src="_images/colored_noise_39_1.svg" /></div>
</div>
<p>Note: the “real” value of <span class="math notranslate nohighlight">\(M_c\)</span> is <span class="math notranslate nohighlight">\(\sim 30 \, M_\odot\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="s1">&#39;Mc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:title={&#39;center&#39;:&#39;Mc&#39;}&gt;
</pre></div>
</div>
<img alt="_images/colored_noise_41_1.svg" src="_images/colored_noise_41_1.svg" /></div>
</div>
</div>
<div class="section" id="state-space-models">
<h2>State Space Models<a class="headerlink" href="#state-space-models" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="n">sigma2</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="k">def</span> <span class="nf">k</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">xj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sigma2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xi</span><span class="o">-</span><span class="n">xj</span><span class="p">)</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>

<span class="n">Sigma</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
        <span class="n">Sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">imshow</span><span class="p">(</span><span class="n">Sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x14bab08e0&gt;
</pre></div>
</div>
<img alt="_images/colored_noise_43_1.svg" src="_images/colored_noise_43_1.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="n">Sigma</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/colored_noise_44_0.svg" src="_images/colored_noise_44_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">terms</span><span class="o">.</span><span class="n">RealTerm</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">celerite2</span><span class="o">.</span><span class="n">GaussianProcess</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">cumsum</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="mi">1024</span><span class="p">))</span><span class="o">/</span><span class="mi">512</span>
<span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x14bc79ca0&gt;]
</pre></div>
</div>
<img alt="_images/colored_noise_46_1.svg" src="_images/colored_noise_46_1.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">gp</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/colored_noise_48_0.svg" src="_images/colored_noise_48_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">celerite_model</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Lognormal</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Lognormal</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">theano_terms</span><span class="o">.</span><span class="n">RealTerm</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">gp</span> <span class="o">=</span> <span class="n">celerite2</span><span class="o">.</span><span class="n">theano</span><span class="o">.</span><span class="n">GaussianProcess</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">marginal</span><span class="p">(</span><span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">celerite_model</span><span class="p">:</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pmx</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3_ext/sampling/sampling.py:97: FutureWarning: In v4.0, pm.sample will return an `arviz.InferenceData` object instead of a `MultiTrace` by default. You can pass return_inferencedata=True or return_inferencedata=False to be safe and silence this warning.
  return pm.sample(draws=draws, tune=tune, model=model, step=step, **kwargs)
Multiprocess sampling (2 chains in 2 jobs)
NUTS: [c, a]
</pre></div>
</div>
<div class="output text_html">
<div>
    <style>
        /* Turns off some styling */
        progress {
            /* gets rid of default border in Firefox and Opera. */
            border: none;
            /* Needs to be in here for Safari polyfill so background images work as expected. */
            background-size: auto;
        }
        .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
            background: #F44336;
        }
    </style>
  <progress value='468' class='' max='4000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  11.70% [468/4000 00:04<00:32 Sampling 2 chains, 0 divergences]
</div>
</div><div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------
RemoteTraceback                           Traceback (most recent call last)
RemoteTraceback: 
&quot;&quot;&quot;
Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/compile/function/types.py&quot;, line 974, in __call__
    self.fn()
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/op.py&quot;, line 476, in rval
    r = p(n, [x[0] for x in i], o)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/theano/ops.py&quot;, line 123, in perform
    func(*args)
celerite2.backprop.LinAlgError: failed to factorize or solve matrix

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/parallel_sampling.py&quot;, line 137, in run
    self._start_loop()
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/parallel_sampling.py&quot;, line 191, in _start_loop
    point, stats = self._compute_point()
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/parallel_sampling.py&quot;, line 216, in _compute_point
    point, stats = self._step_method.step(self._point)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/arraystep.py&quot;, line 276, in step
    apoint, stats = self.astep(array)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/hmc/base_hmc.py&quot;, line 168, in astep
    hmc_step = self._hamiltonian_step(start, p0, step_size)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/hmc/nuts.py&quot;, line 184, in _hamiltonian_step
    divergence_info, turning = tree.extend(direction)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/hmc/nuts.py&quot;, line 283, in extend
    tree, diverging, turning = self._build_subtree(
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/hmc/nuts.py&quot;, line 368, in _build_subtree
    tree2, diverging, turning = self._build_subtree(tree1.right, depth - 1, epsilon)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/hmc/nuts.py&quot;, line 362, in _build_subtree
    return self._single_step(left, epsilon)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/hmc/nuts.py&quot;, line 324, in _single_step
    right = self.integrator.step(epsilon, left)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/hmc/integration.py&quot;, line 69, in step
    return self._step(epsilon, state)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/step_methods/hmc/integration.py&quot;, line 102, in _step
    logp = self._logp_dlogp_func(q_new, q_new_grad)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/model.py&quot;, line 734, in __call__
    output = self._theano_function(array)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/compile/function/types.py&quot;, line 987, in __call__
    raise_with_op(
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/link/utils.py&quot;, line 508, in raise_with_op
    raise exc_value.with_traceback(exc_trace)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/compile/function/types.py&quot;, line 974, in __call__
    self.fn()
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/op.py&quot;, line 476, in rval
    r = p(n, [x[0] for x in i], o)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/theano/ops.py&quot;, line 123, in perform
    func(*args)
celerite2.backprop.LinAlgError: failed to factorize or solve matrix
Apply node that caused the error: _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Alloc.0, Rebroadcast{?,0}.0, TensorConstant{(1024, 1) of 1.0})
Toposort index: 20
Inputs types: [TensorType(float64, vector), TensorType(float64, vector), TensorType(float64, vector), TensorType(float64, matrix), TensorType(float64, matrix)]
Inputs shapes: [(1024,), (1,), (1024,), (1024, 1), (1024, 1)]
Inputs strides: [(8,), (8,), (8,), (8, 8), (8, 8)]
Inputs values: [&#39;not shown&#39;, array([1.7029458e-17]), &#39;not shown&#39;, &#39;not shown&#39;, &#39;not shown&#39;]
Outputs clients: [[_CeleriteOp{name=&#39;factor_rev&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Alloc.0, Rebroadcast{?,0}.0, TensorConstant{(1024, 1) of 1.0}, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.2, Elemwise{Composite{((i0 / i1) + ((i2 * i3) / sqr(i1)))}}.0, _CeleriteOp{name=&#39;solve_lower_rev&#39;, quiet=False}.3), Elemwise{Composite{((i0 / i1) + ((i2 * i3) / sqr(i1)))}}(TensorConstant{(1,) of -0.5}, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0, TensorConstant{(1,) of 0.5}, Elemwise{Sqr}[(0, 0)].0), Elemwise{Composite{((-i0) / i1)}}(InplaceDimShuffle{0}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0), Elemwise{TrueDiv}[(0, 0)](Elemwise{Sqr}[(0, 0)].0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0), Elemwise{Log}[(0, 0)](_CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0)], [_CeleriteOp{name=&#39;solve_lower_fwd&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Rebroadcast{?,0}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, TensorConstant{[[-0.52539..00782597]]}), _CeleriteOp{name=&#39;solve_lower_rev&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Rebroadcast{?,0}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, TensorConstant{[[-0.52539..00782597]]}, _CeleriteOp{name=&#39;solve_lower_fwd&#39;, quiet=False}.0, _CeleriteOp{name=&#39;solve_lower_fwd&#39;, quiet=False}.1, IncSubtensor{InplaceInc;::, int64}.0), _CeleriteOp{name=&#39;factor_rev&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Alloc.0, Rebroadcast{?,0}.0, TensorConstant{(1024, 1) of 1.0}, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.2, Elemwise{Composite{((i0 / i1) + ((i2 * i3) / sqr(i1)))}}.0, _CeleriteOp{name=&#39;solve_lower_rev&#39;, quiet=False}.3)], [_CeleriteOp{name=&#39;factor_rev&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Alloc.0, Rebroadcast{?,0}.0, TensorConstant{(1024, 1) of 1.0}, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.2, Elemwise{Composite{((i0 / i1) + ((i2 * i3) / sqr(i1)))}}.0, _CeleriteOp{name=&#39;solve_lower_rev&#39;, quiet=False}.3)]]

Backtrace when the node is created(use Theano flag traceback__limit=N to make it longer):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 3364, in run_ast_nodes
    if (await self.run_code(code, result,  async_=asy)):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 3444, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/ipykernel_75005/81582006.py&quot;, line 7, in &lt;module&gt;
    gp.compute(ts)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/core.py&quot;, line 316, in compute
    self._do_compute(quiet)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/theano/celerite2.py&quot;, line 83, in _do_compute
    self._d, self._W, _ = ops.factor(
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/op.py&quot;, line 250, in __call__
    node = self.make_node(*inputs, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/theano/ops.py&quot;, line 83, in make_node
    otypes = [
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/theano/ops.py&quot;, line 84, in &lt;listcomp&gt;
    tt.TensorType(

HINT: Use the Theano flag &#39;exception_verbosity=high&#39; for a debugprint and storage map footprint of this apply node.
&quot;&quot;&quot;

The above exception was the direct cause of the following exception:

LinAlgError                               Traceback (most recent call last)
LinAlgError: failed to factorize or solve matrix
Apply node that caused the error: _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Alloc.0, Rebroadcast{?,0}.0, TensorConstant{(1024, 1) of 1.0})
Toposort index: 20
Inputs types: [TensorType(float64, vector), TensorType(float64, vector), TensorType(float64, vector), TensorType(float64, matrix), TensorType(float64, matrix)]
Inputs shapes: [(1024,), (1,), (1024,), (1024, 1), (1024, 1)]
Inputs strides: [(8,), (8,), (8,), (8, 8), (8, 8)]
Inputs values: [&#39;not shown&#39;, array([1.7029458e-17]), &#39;not shown&#39;, &#39;not shown&#39;, &#39;not shown&#39;]
Outputs clients: [[_CeleriteOp{name=&#39;factor_rev&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Alloc.0, Rebroadcast{?,0}.0, TensorConstant{(1024, 1) of 1.0}, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.2, Elemwise{Composite{((i0 / i1) + ((i2 * i3) / sqr(i1)))}}.0, _CeleriteOp{name=&#39;solve_lower_rev&#39;, quiet=False}.3), Elemwise{Composite{((i0 / i1) + ((i2 * i3) / sqr(i1)))}}(TensorConstant{(1,) of -0.5}, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0, TensorConstant{(1,) of 0.5}, Elemwise{Sqr}[(0, 0)].0), Elemwise{Composite{((-i0) / i1)}}(InplaceDimShuffle{0}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0), Elemwise{TrueDiv}[(0, 0)](Elemwise{Sqr}[(0, 0)].0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0), Elemwise{Log}[(0, 0)](_CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0)], [_CeleriteOp{name=&#39;solve_lower_fwd&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Rebroadcast{?,0}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, TensorConstant{[[-0.52539..00782597]]}), _CeleriteOp{name=&#39;solve_lower_rev&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Rebroadcast{?,0}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, TensorConstant{[[-0.52539..00782597]]}, _CeleriteOp{name=&#39;solve_lower_fwd&#39;, quiet=False}.0, _CeleriteOp{name=&#39;solve_lower_fwd&#39;, quiet=False}.1, IncSubtensor{InplaceInc;::, int64}.0), _CeleriteOp{name=&#39;factor_rev&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Alloc.0, Rebroadcast{?,0}.0, TensorConstant{(1024, 1) of 1.0}, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.2, Elemwise{Composite{((i0 / i1) + ((i2 * i3) / sqr(i1)))}}.0, _CeleriteOp{name=&#39;solve_lower_rev&#39;, quiet=False}.3)], [_CeleriteOp{name=&#39;factor_rev&#39;, quiet=False}(TensorConstant{[0.0014975...99701957]}, Rebroadcast{0}.0, Alloc.0, Rebroadcast{?,0}.0, TensorConstant{(1024, 1) of 1.0}, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.0, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.1, _CeleriteOp{name=&#39;factor_fwd&#39;, quiet=False}.2, Elemwise{Composite{((i0 / i1) + ((i2 * i3) / sqr(i1)))}}.0, _CeleriteOp{name=&#39;solve_lower_rev&#39;, quiet=False}.3)]]

Backtrace when the node is created(use Theano flag traceback__limit=N to make it longer):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 3364, in run_ast_nodes
    if (await self.run_code(code, result,  async_=asy)):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 3444, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/ipykernel_75005/81582006.py&quot;, line 7, in &lt;module&gt;
    gp.compute(ts)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/core.py&quot;, line 316, in compute
    self._do_compute(quiet)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/theano/celerite2.py&quot;, line 83, in _do_compute
    self._d, self._W, _ = ops.factor(
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/op.py&quot;, line 250, in __call__
    node = self.make_node(*inputs, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/theano/ops.py&quot;, line 83, in make_node
    otypes = [
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/celerite2/theano/ops.py&quot;, line 84, in &lt;listcomp&gt;
    tt.TensorType(

HINT: Use the Theano flag &#39;exception_verbosity=high&#39; for a debugprint and storage map footprint of this apply node.

The above exception was the direct cause of the following exception:

RuntimeError                              Traceback (most recent call last)
/var/folders/35/vcq24mtj2_g5wk96mbck0cw400018s/T/ipykernel_75005/3804014418.py in &lt;module&gt;
      1 with celerite_model:
----&gt; 2     trace = pmx.sample()

~/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3_ext/sampling/sampling.py in sample(draws, tune, model, step_kwargs, warmup_window, adapt_window, cooldown_window, initial_accept, target_accept, gamma, k, t0, parameter_groups, adapt_type, recompute_interval, regularization_steps, regularization_variance, **kwargs)
     95     )
     96 
---&gt; 97     return pm.sample(draws=draws, tune=tune, model=model, step=step, **kwargs)

~/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/sampling.py in sample(draws, step, init, n_init, start, trace, chain_idx, chains, cores, tune, progressbar, model, random_seed, discard_tuned_samples, compute_convergence_checks, callback, jitter_max_retries, return_inferencedata, idata_kwargs, mp_ctx, pickle_backend, **kwargs)
    557         _print_step_hierarchy(step)
    558         try:
--&gt; 559             trace = _mp_sample(**sample_args, **parallel_args)
    560         except pickle.PickleError:
    561             _log.warning(&quot;Could not pickle model, sampling singlethreaded.&quot;)

~/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/sampling.py in _mp_sample(draws, tune, step, chains, cores, chain, random_seed, start, progressbar, trace, model, callback, discard_tuned_samples, mp_ctx, pickle_backend, **kwargs)
   1475         try:
   1476             with sampler:
-&gt; 1477                 for draw in sampler:
   1478                     trace = traces[draw.chain - chain]
   1479                     if trace.supports_sampler_stats and draw.stats is not None:

~/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/parallel_sampling.py in __iter__(self)
    477 
    478         while self._active:
--&gt; 479             draw = ProcessAdapter.recv_draw(self._active)
    480             proc, is_last, draw, tuning, stats, warns = draw
    481             self._total_draws += 1

~/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/pymc3/parallel_sampling.py in recv_draw(processes, timeout)
    357             else:
    358                 error = RuntimeError(&quot;Chain %s failed.&quot; % proc.chain)
--&gt; 359             raise error from old_error
    360         elif msg[0] == &quot;writing_done&quot;:
    361             proc._readable = True

RuntimeError: Chain 0 failed.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pm</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Got error No model on context stack. trying to find log_likelihood in translation.
/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/arviz/data/io_pymc3_3x.py:98: FutureWarning: Using `from_pymc3` without the model will be deprecated in a future release. Not using the model will return less accurate and less useful results. Make sure you use the model argument or call from_pymc3 within a model context.
  warnings.warn(
ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

Got error No model on context stack. trying to find log_likelihood in translation.
ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;

ERROR (theano.graph.opt): Optimization failure due to: local_join_empty
ERROR (theano.graph.opt): node: Join(TensorConstant{0}, Elemwise{exp,no_inplace}.0, TensorConstant{[]}, TensorConstant{[]})
ERROR (theano.graph.opt): TRACEBACK:
ERROR (theano.graph.opt): Traceback (most recent call last):
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 2017, in process_node
    replacements = lopt.transform(fgraph, node)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4181, in local_join_empty
    ret = tt.patternbroadcast(ret, node.outputs[0].broadcastable)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/basic.py&quot;, line 4181, in patternbroadcast
    return theano.tensor.opt.apply_rebroadcast_opt(rval)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4103, in apply_rebroadcast_opt
    rval2 = local_rebroadcast_lift.transform(None, rval.owner)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/graph/opt.py&quot;, line 1209, in transform
    return self.fn(*args, **kwargs)
  File &quot;/Users/wfarr/miniconda3/envs/Astrostatistics688/lib/python3.9/site-packages/theano/tensor/opt.py&quot;, line 4046, in local_rebroadcast_lift
    if len(fgraph.clients[input]) == 1:
AttributeError: &#39;NoneType&#39; object has no attribute &#39;clients&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;AxesSubplot:title={&#39;center&#39;:&#39;a&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;a&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;c&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;c&#39;}&gt;]], dtype=object)
</pre></div>
</div>
<img alt="_images/colored_noise_52_2.svg" src="_images/colored_noise_52_2.svg" /></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="regression_and_curve_fitting.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Regression and Curve Fitting</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="gaussian_processes.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Gaussian Processes</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Will M. Farr<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>